$ErrorActionPreference = 'Stop'

$packageArgs = @{
  packageName = $env:ChocolateyPackageName
  softwareName = 'HHD Software Free Hex Editor Neo [0-9]*.[0-9]*'
  fileType = 'exe'
  url = '$url$'
  silentArgs = 'WILL BE DETERMINED IN THE NEXT STEP'
  checksum = '$checksum$'
  checksumType = 'sha1'
}

if (Get-UninstallRegistryKey -SoftwareName 'HDD Software Free Hex Editor Neo [0-9]+\.[0-9]+') {
  $packageArgs.silentArgs = '-silent -machine -type 2'
} else {
  $packageArgs.silentArgs = '-silent -machine'
}

Install-ChocolateyPackage @packageArgs
